C51 COMPILER V9.01   MAIN                                                                  11/04/2020 14:51:56 PAGE 1   


C51 COMPILER V9.01, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN main.OBJ
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE main.c BROWSE DEBUG OBJECTEXTEND

line level    source

   1          /*********************************************************************************
   2          *实 验 名       ：外部中断实验
   3          *注    意           ：由于P3.2口跟红外线共用，所以做按键实验时为了不让红外线影响实验效果，最好把红外线先
   4          *取下来。
   5          *实验效果           ：K3按下LED左循环，K4按下LED变右循环
   6          *
   7          *********************************************************************************/
   8          #include<reg51.h>
   9          #include<intrins.h>
  10          
  11          #define GPIO_LED        P2
  12          //外部中断的IO
  13          sbit K3=P3^2;
  14          sbit K4=P3^3;
  15          
  16          void IntConfiguration();
  17          void Delay(unsigned int n);
  18          unsigned char KeyValue=0;
  19          /*******************************************************************************
  20          * 函 数 名       : main
  21          * 函数功能               : 主函数
  22          * 输    入       : 无
  23          * 输    出       : 无
  24          *******************************************************************************/
  25          void main(void)                                         
  26          {
  27   1              GPIO_LED=0Xfe;
  28   1              IntConfiguration();
  29   1              while(1)
  30   1              {
  31   2                      if(KeyValue)
  32   2                              GPIO_LED=_crol_(GPIO_LED,1);
  33   2                      else
  34   2                              GPIO_LED=_cror_(GPIO_LED,1);
  35   2                      Delay(2000);            
  36   2              }       
  37   1      }
  38          /*******************************************************************************
  39          * 函 数 名         : IntConfiguration()
  40          * 函数功能                 : 设置外部中断
  41          * 输    入         : 无
  42          * 输    出         : 无
  43          *******************************************************************************/
  44          void IntConfiguration()
  45          {
  46   1              //设置INT0
  47   1              IT0=1;//跳变沿出发方式（下降沿）
  48   1              EX0=1;//打开INT0的中断允许。
  49   1              //设置INT1
  50   1              IT1=1;
  51   1              EX1=1;
  52   1              
  53   1              EA=1;//打开总中断       
  54   1      }
  55          /*******************************************************************************
C51 COMPILER V9.01   MAIN                                                                  11/04/2020 14:51:56 PAGE 2   

  56          * 函 数 名         : Delay(unsigned int n)
  57          * 函数功能                 : 延时
  58          * 输    入         : n
  59          * 输    出         : 无
  60          *******************************************************************************/
  61          
  62          void Delay(unsigned int n)   //延时50us误差 0us
  63          {
  64   1          unsigned char a,b;
  65   1                      for(;n>0;n--)
  66   1                      {
  67   2              for(b=1;b>0;b--)
  68   2              for(a=22;a>0;a--);
  69   2                      }
  70   1      }
  71          /*******************************************************************************
  72          * 函 数 名         : Int0()     interrupt 0
  73          * 函数功能                 : 外部中断0的中断函数
  74          * 输    入         : 无
  75          * 输    出         : 无
  76          *******************************************************************************/
  77          
  78          void Int0()     interrupt 0             //外部中断0的中断函数
  79          {
  80   1              Delay(1);        //延时消抖
  81   1      
  82   1                      KeyValue=1;
  83   1      }
  84          /*******************************************************************************
  85          * 函 数 名         : Int1() interrupt 2
  86          * 函数功能                 : 外部中断1的中断函数
  87          * 输    入         : 无
  88          * 输    出         : 无
  89          *******************************************************************************/
  90          
  91          void Int1() interrupt 2         //外部中断1的中断函数
  92          {
  93   1              Delay(1);               //延时消抖
  94   1      
  95   1                      KeyValue=0;     
  96   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    159    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      1    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
